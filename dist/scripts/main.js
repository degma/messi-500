"use strict";var MessiViz;!function(t,s,e,i){MessiViz=t.MessiViz=t.MessiViz||{},MessiViz.MATCHES,MessiViz.GOALS,MessiViz.team="ARG",MessiViz.SELECTED=null,MessiViz.selectedSlide="item-home",MessiViz.$loader=e("#loader-container"),MessiViz.competitions=["PRM","CUP","EUR","FRN","WCQ","WCP","SUP","IUP","CPA","WCT"],MessiViz.competitionName={PRM:"La Liga española",CUP:"Copa del Rey de España",EUR:"UEFA Champions League",FRN:"Amistoso internacional",WCQ:"Eliminatorias para la copa del mundo",WCP:"Copa del mundo",SUP:"Super Copa de España",IUP:"Super Copa de Europa UEFA",CPA:"Copa América",WCT:"Mundial de clubes"},MessiViz.hows=["Left foot","Right foot","Head","Hand","Chest"],MessiViz.teams=["Argentina","FC Barcelona"],MessiViz.color=i.scale.ordinal().domain(MessiViz.competitions).range(i.scale.category10().range()),MessiViz.colorHow=i.scale.ordinal().domain(MessiViz.hows).range(i.scale.category10().range()),MessiViz.colorTeam=i.scale.ordinal().domain(MessiViz.teams).range(i.scale.category10().range()),MessiViz.colorMinutes=i.scale.threshold().domain([0,1,3,5,7,9,11,13,30]).range(["#fff","#ffffe0","#ffdfa9","#ffbd84","#ff976d","#f47461","#e25056","#cb2f44","#ae112a","#8b0000"]),MessiViz.svg,MessiViz.groups={},MessiViz.totals={$goals:e(".totals-goals"),$assists:e("#totals-assists"),$minutes:e("#totals-minutes"),$matches:e("#totals-matches"),$goalsLeft:e("#totals-goals-left"),$goalsRight:e("#totals-goals-right"),$goalsHead:e("#totals-goals-head"),$goalsHand:e("#totals-goals-hand"),$goalsChest:e("#totals-goals-chest"),$goalsArg:e("#totals-goals-argentina"),$goalsBar:e("#totals-goals-barcelona"),$activeFilter:e("#active-filter"),$iconFilter:e("#icon-filter"),$messiContainer:e("#messi-container"),$svgMinutes:e("#svg-minutes-container")},MessiViz.barGap={x:0,y:0},MessiViz.init=function(){i.csv("./data/messi-500-matches.csv",function(t){MessiViz.MATCHES=t,i.csv("./data/messi-500-goals.csv",function(t){MessiViz.GOALS=t,MessiViz.dataLoaded()})}),i.xml("./images/messi-01.svg","image/svg+xml",function(t,s){if(t)throw t;MessiViz.totals.$messiContainer.html(s.documentElement),e("#messi-container svg path").each(function(t,s){var i=e(s);"#49869D"==i.attr("fill")?i.addClass("color1"):"#FFFFFF"==i.attr("fill")&&i.addClass("color2")}),setInterval(function(){"ARG"==MessiViz.team?(MessiViz.team="BAR",i.selectAll("#messi-container svg path.color1").transition().duration(2e3).attr("fill","#003173"),i.selectAll("#messi-container svg path.color2").transition().duration(2e3).attr("fill","#831F3B")):(MessiViz.team="ARG",i.selectAll("#messi-container svg path.color1").transition().duration(2e3).attr("fill","#49869D"),i.selectAll("#messi-container svg path.color2").transition().duration(2e3).attr("fill","#FFFFFF"))},5e3)})},MessiViz.dataLoaded=function(){var t=i.nest().key(function(t){return t.date}).map(MessiViz.GOALS);_.forEach(MessiViz.MATCHES,function(s){t[s.date]?s.details=t[s.date]:s.details=[]}),MessiViz.renderD3Chart(MessiViz.MATCHES,2e3),MessiViz.initEvents(),MessiViz.hideTooltip()},MessiViz.renderD3Chart=function(t,s){MessiViz.SELECTED_MATCHES=t.map(function(t,s){t.index=s}),MessiViz.svg||(MessiViz.margin={top:0,right:0,bottom:0,left:0},MessiViz.width=e(window).width()-MessiViz.margin.left-MessiViz.margin.right,MessiViz.height=e(window).height()-MessiViz.margin.top-MessiViz.margin.bottom,MessiViz.chartSize=100,e(".carousel-inner,.item").height(MessiViz.height-e(".masthead").height()-MessiViz.chartSize),MessiViz.svg=i.select("#svg-container").append("svg").classed("main-svg",!0).attr("width",MessiViz.width+MessiViz.margin.left+MessiViz.margin.right).attr("height",MessiViz.height+MessiViz.margin.top+MessiViz.margin.bottom).append("g").attr("transform","translate("+MessiViz.margin.left+","+MessiViz.margin.top+")"),MessiViz.tooltip=i.select("body").append("div").classed("info-tooltip",!0).style("top",0).style("left",0).style("width",MessiViz.width/4+"px").style("height",MessiViz.height/4+"px").style("display","block"),MessiViz.$loader.removeClass("loading")),MessiViz.tooltipx=i.scale.linear().domain([0,MessiViz.SELECTED_MATCHES.length]).range([MessiViz.chartSize,MessiViz.width-MessiViz.width/4-MessiViz.chartSize]),MessiViz.tooltipy=i.scale.linear().domain([0,MessiViz.SELECTED_MATCHES.length]).range([0,MessiViz.height-MessiViz.height/4-MessiViz.chartSize]),s=s?s:0,MessiViz.renderGoals(t,s),MessiViz.renderAssists(t,s),MessiViz.renderMinutes(t,s),MessiViz.updateTotals(t),MessiViz.lineh||(MessiViz.lineh=MessiViz.svg.append("line").classed("lineh",!0).attr("x1",0).attr("y1",0).attr("x2",MessiViz.width).attr("y2",0),MessiViz.linev=MessiViz.svg.append("line").classed("linev",!0).attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",MessiViz.height))},MessiViz.renderGoals=function(t,s){MessiViz.groups.goals||(MessiViz.groups.goals=MessiViz.svg.append("g").classed("goals",!0),MessiViz.maxGoals=i.max(t,function(t){return t.goals}),MessiViz.totals.goals=MessiViz.groups.goals.append("text").text(function(t){return""}).classed("totals-number",!0).attr("id","totals-number-goals").attr("y",function(t,s){return MessiViz.height/2}).attr("x",function(t,s){return(MessiViz.width-2*MessiViz.chartSize)/4}).attr("text-anchor","middle"),MessiViz.groups.goals.append("text").text(function(t){return"GOLES"}).classed("totals-label",!0).attr("y",function(t,s){return 0}).attr("x",function(t,s){return MessiViz.height/2-MessiViz.chartSize/2}).attr("text-anchor","middle").attr("transform","rotate(90)"));var e=i.scale.ordinal().domain([0,t.length]).rangeBands([0,MessiViz.height-MessiViz.chartSize]),a=i.scale.linear().domain(i.range(0,6,1)).range([0,MessiViz.chartSize]);e.domain(t.map(function(t,s){return s})),a.domain([0,MessiViz.maxGoals]),MessiViz.barGap.y=e.rangeBand();var r=MessiViz.groups.goals.selectAll(".bar.bar-goal").data(t);r.exit().remove(),r.enter().append("rect").attr("x",function(t,s){return 0}).attr("width",function(t){return 0}),r.attr("class",function(t,s){return"match"+t.id+" "+t.competition}).classed("bar",!0).classed("bar-unit",!0).classed("bar-goal",!0).transition().delay(function(t,e){return 5*e+s}).attr("fill","#ddd").attr("y",function(t,s){return e(s)}).attr("height",e.rangeBand()).attr("width",function(t){return 0==a(t.goals)?2:a(t.goals)});var r=MessiViz.groups.goals.selectAll(".bar.bar-goal-fill").data(t);r.exit().remove(),r.enter().append("rect").classed("bar",!0).classed("bar-goal-fill",!0).attr("fill","transparent").attr("x",function(t,s){return 0}).attr("width",function(t){return a(MessiViz.maxGoals)}),r.attr("y",function(t,s){return e(s)}).attr("height",e.rangeBand()).on("mouseover",function(t){MessiViz.hover(t)}).on("mouseout",function(t){MessiViz.unhover(t)})},MessiViz.renderAssists=function(t,s){MessiViz.groups.assists||(MessiViz.groups.assists=MessiViz.svg.append("g").classed("assists",!0),MessiViz.maxAssists=i.max(t,function(t){return t.assists}),MessiViz.totals.assists=MessiViz.groups.assists.append("text").text(function(t){return""}).classed("totals-number",!0).attr("id","totals-number-assists").attr("y",function(t,s){return MessiViz.height/2}).attr("x",function(t,s){return MessiViz.width-MessiViz.chartSize-(MessiViz.width-2*MessiViz.chartSize)/4}).attr("text-anchor","middle"),MessiViz.groups.assists.append("text").text(function(t){return"ASISTENCIAS"}).classed("totals-label-assists",!0).attr("y",function(t,s){return MessiViz.width}).attr("x",function(t,s){return-MessiViz.height/2+MessiViz.chartSize/2}).attr("text-anchor","middle").attr("transform","rotate(270)"));var e=i.scale.ordinal().domain([0,t.length]).rangeBands([0,MessiViz.height-MessiViz.chartSize]),a=i.scale.linear().domain(i.range(0,MessiViz.maxAssists,1)).range([0,MessiViz.chartSize]);e.domain(t.map(function(t,s){return s})),a.domain([0,MessiViz.maxAssists]);var r=MessiViz.groups.assists.selectAll(".bar.bar-assist").data(t);r.exit().remove(),r.enter().append("rect").attr("x",function(t,s){return MessiViz.width}).attr("width",function(t){return 0}),r.attr("class",function(t,s){return"match"+t.id+" "+t.competition}).classed("bar",!0).classed("bar-unit",!0).classed("bar-assist",!0).transition().delay(function(t,e){return 5*e+s}).attr("fill","#ddd").attr("y",function(t,s){return e(s)}).attr("height",e.rangeBand()).attr("width",function(t){return 0==a(t.assists)?2:a(t.assists)}).attr("x",function(t,s){var e=0==a(t.assists)?2:a(t.assists);return MessiViz.width-e});var r=MessiViz.groups.assists.selectAll(".bar.bar-assist-fill").data(t);r.exit().remove(),r.enter().append("rect").classed("bar",!0).classed("bar-assist-fill",!0).attr("fill","transparent").attr("x",function(t,s){return MessiViz.width-a(MessiViz.maxAssists)}).attr("width",function(t){return a(MessiViz.maxAssists)}),r.attr("y",function(t,s){return e(s)}).attr("height",e.rangeBand()).on("mouseover",function(t){MessiViz.hover(t)}).on("mouseout",function(t){MessiViz.unhover(t)})},MessiViz.renderMinutes=function(t,s){MessiViz.groups.minutes||(MessiViz.groups.minutes=MessiViz.svg.append("g").classed("minutes",!0),MessiViz.maxMinutes=i.max(t,function(t){return parseInt(t.minutes)}),MessiViz.totals.minutes=MessiViz.groups.minutes.append("text").text(function(t){return""}).classed("totals-number",!0).attr("id","totals-number-minutes").attr("y",function(t,s){return MessiViz.height/2}).attr("x",function(t,s){return MessiViz.width/2}).attr("text-anchor","middle"),MessiViz.totals.matches=MessiViz.groups.minutes.append("text").text(function(t){return""}).classed("totals-number",!0).attr("id","totals-number-matches").attr("y",function(t,s){return MessiViz.height/2+200}).attr("x",function(t,s){return MessiViz.width/2}).attr("text-anchor","middle"),MessiViz.groups.minutes.append("text").text(function(t){return"MINUTOS"}).classed("totals-label",!0).attr("y",function(t,s){return MessiViz.height}).attr("x",function(t,s){return MessiViz.width/2}).attr("text-anchor","middle"));var e=i.scale.ordinal().domain([0,t.length]).rangeBands([MessiViz.chartSize,MessiViz.width-MessiViz.chartSize]),a=i.scale.linear().domain(i.range(0,MessiViz.maxMinutes,1)).range([0,MessiViz.chartSize]);e.domain(t.map(function(t,s){return s})),a.domain([0,MessiViz.maxMinutes]),MessiViz.barGap.x=e.rangeBand();var r=MessiViz.groups.minutes.selectAll(".bar.bar-minute").data(t);r.exit().remove(),r.enter().append("rect").attr("y",function(t,s){return MessiViz.height}).attr("height",function(t){return 0}),r.attr("class",function(t,s){return"match"+t.id+" "+t.competition}).classed("bar",!0).classed("bar-unit",!0).classed("bar-minute",!0).transition().delay(function(t,e){return 5*e+s}).attr("fill","#ddd").attr("x",function(t,s){return e(s)}).attr("width",e.rangeBand()).attr("y",function(t,s){return MessiViz.height-a(t.minutes)}).attr("height",function(t){return a(t.minutes)});var r=MessiViz.groups.minutes.selectAll(".bar.bar-minute-fill").data(t);r.exit().remove(),r.enter().append("rect").classed("bar",!0).classed("bar-minute-fill",!0).attr("fill","transparent").attr("y",function(t,s){return MessiViz.height-a(MessiViz.maxMinutes)}).attr("height",function(t){return a(MessiViz.maxMinutes)}),r.attr("width",e.rangeBand()).attr("x",function(t,s){return e(s)}).on("mouseover",function(t){MessiViz.hover(t)}).on("mouseout",function(t){MessiViz.unhover(t)})},MessiViz.renderMinutesMatrix=function(){var t=i.nest().key(function(t){var s=parseInt(t.minute);return t.minute>90?90:s}).entries(MessiViz.GOALS_SELECTED);i.range(1,91).forEach(function(s){_.find(t,{key:""+s})||t.push({key:s,values:[]})}),t.sort(function(t,s){return parseInt(t.key)>parseInt(s.key)});var s=MessiViz.totals.$svgMinutes.parent().innerHeight(),e=MessiViz.totals.$svgMinutes.parent().innerWidth();MessiViz.groups.matrix||(MessiViz.matrixMargin={top:10,right:0,bottom:10,left:0},MessiViz.matrixSvg=i.select("#svg-minutes-container").append("svg").classed("matrix-svg",!0).attr("width",e).attr("height",s),MessiViz.groups.matrix=MessiViz.matrixSvg.append("g").classed("matrix-group",!0).attr("transform","translate("+MessiViz.matrixMargin.left+","+MessiViz.matrixMargin.top+")"));var a=i.scale.ordinal().domain(i.range(1,11)).rangeBands([0,e]),r=i.scale.ordinal().domain(i.range(1,10)).rangeBands([0,s-MessiViz.matrixMargin.top-MessiViz.matrixMargin.bottom]),n=MessiViz.groups.matrix.selectAll(".matrix-back").data(t);n.enter().append("rect").attr("x",function(t,s){return a(t.key%10==0?10:t.key%10)}).attr("y",function(t,s){return r(Math.ceil(t.key/10))}).attr("height",r.rangeBand()).attr("width",a.rangeBand()),n.attr("class",function(t,s){return"minute"+t.key}).classed("matrix-back",!0).transition().attr("fill",function(t){return MessiViz.colorMinutes(t.values.length)});var o=MessiViz.groups.matrix.selectAll(".matrix-goals").data(t);o.enter().append("text").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("x",function(t,s){return a(t.key%10==0?10:t.key%10)+a.rangeBand()/2}).attr("y",function(t,s){return r(Math.ceil(t.key/10))+r.rangeBand()/2+r.rangeBand()/4}),o.attr("class",function(t,s){return"minute"+t.key}).text(function(t){return t.values.length}).classed("matrix-goals",!0).attr("fill","#000");var o=MessiViz.groups.matrix.selectAll(".matrix-minute").data(t);o.enter().append("text").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("x",function(t,s){return a(t.key%10==0?10:t.key%10)+a.rangeBand()/2}).attr("y",function(t,s){return r(Math.ceil(t.key/10))+r.rangeBand()/2-r.rangeBand()/4}),o.attr("class",function(t,s){return"minute"+t.key}).text(function(t){return 90==t.key?"90'+":t.key+"'"}).classed("matrix-minute",!0).attr("fill","#333")},MessiViz.hover=function(t){MessiViz.SELECTED=t.id,i.selectAll("rect.match"+t.id).classed("selectedMatch",!0),i.selectAll("circle.match"+t.id).classed("selectedGoal",!0);var s=i.select("rect.bar-minute.match"+t.id).attr("x");MessiViz.linev.transition().style("opacity",1).attr("x1",Math.round(s)+Math.round(MessiViz.barGap.x/2)).attr("x2",Math.round(s)+Math.round(MessiViz.barGap.x/2));var e=i.select("rect.bar-goal.match"+t.id).attr("y");MessiViz.lineh.transition().style("opacity",1).attr("y1",Math.round(e)+Math.round(MessiViz.barGap.y/2)).attr("y2",Math.round(e)+Math.round(MessiViz.barGap.y/2)),MessiViz.tooltip.html(function(){var s=t.home_goals>t.away_goals?"home":"away",e=t.home_goals<t.away_goals?"home":"away",i="<p>El día <strong>"+t.date+"</strong>, <strong>"+t.home+"</strong> recibió a <strong>"+t.away+"</strong> por <strong>"+MessiViz.competitionName[t.competition]+"</strong>.";return i+=s==e?" Fue empate ":"home"==e?" Fue victoria para los visitantes ":" Los locales se impusieron ",i+="<strong>"+t.home_goals+"-"+t.away_goals+"</strong>.",i+=0==t.goals?" Messi no marcó goles":1==t.goals?" Messi marcó <strong>un</strong> gol en el minuto "+t.details[0].minute:" Messi marcó <strong>"+t.goals+"</strong> goles",i+=0==t.assists?", no hizo asistencias":1==t.assists?", realizó <strong>una</strong> asistencia":", sumó <strong>"+t.assists+"</strong> asistencias",t.minutes>=90?(i+=", jugando el partido completo",120==t.minutes&&(i+=" mas el alargue"),i+="."):i+=t.minutes<45?", jugando apenas <strong>"+t.minutes+"</strong> minutos.":", participando <strong>"+t.minutes+"</strong> minutos.",i+"</p>"}).transition().style("opacity","1").style("left",MessiViz.tooltipx(t.index)+"px").style("top",MessiViz.tooltipy(t.index)+"px")},MessiViz.unhover=function(t,s){i.selectAll("rect.bar").classed("selectedMatch",!1),i.selectAll("circle.goal").classed("selectedGoal",!1)},MessiViz.hideTooltip=function(t,s){MessiViz.tooltip.transition().style("opacity","0"),MessiViz.linev.transition().attr("x1",0).attr("x2",MessiViz.width).style("opacity",0),MessiViz.lineh.transition().attr("y1",MessiViz.height).attr("y2",0).style("opacity",0)},MessiViz.initEvents=function(){e(s).keydown(function(t){switch(t.which){case 37:case 38:MessiViz.prev();break;case 39:case 40:MessiViz.next();break;case 27:MessiViz.hideTooltip();break;default:return}t.preventDefault()}),e(".btn-filter").on("click",function(){var t=e(this);MessiViz.totals.$activeFilter.html(t.html()),MessiViz.totals.$iconFilter.fadeOut(),t.parent().addClass("disabled").siblings().removeClass("disabled"),MessiViz.hideTooltip(),MessiViz.filter(t.data("field"),t.data("filter"))}),e("#clear-filter").on("click",function(){MessiViz.totals.$activeFilter.html("total"),MessiViz.totals.$iconFilter.fadeIn(),e(".btn-filter").parent().removeClass("disabled"),MessiViz.clear()}),e("#filtersModal").on("show.bs.modal",function(t){MessiViz.hideTooltip()}),e("#carousel-messi").carousel({interval:!1}).off("keydown.bs.carousel"),e(".container").mouseenter(function(){MessiViz.hideTooltip(),MessiViz.clearBars()}),e("svg.main-svg").mouseenter(function(){MessiViz.showBars()}),e("#carousel-messi").on("slid.bs.carousel",function(t){var s=e(t.relatedTarget).attr("id");MessiViz.selectedSlide=s,MessiViz.updateBySlide()}),e("#enter").on("click",function(){MessiViz.$loader.fadeOut()})},MessiViz.updateBySlide=function(){switch(console.log(MessiViz.selectedSlide),MessiViz.selectedSlide){case"item-home":MessiViz.hideForceLayout();break;case"item-totals":MessiViz.renderForceLayout();break;case"item-goals":MessiViz.renderForceLayout(),MessiViz.goalsByHow();break;case"item-teams":MessiViz.renderForceLayout(),MessiViz.goalsByTeam();break;case"item-minutes":MessiViz.hideForceLayout(),MessiViz.renderMinutesMatrix()}},MessiViz.renderForceLayout=function(){function t(t){var s=t.radius+20,e=t.x-s,i=t.x+s,a=t.y-s,r=t.y+s;return function(s,n,o,l,c){if(s.point&&s.point!==t){var u=t.x-s.point.x,d=t.y-s.point.y,M=Math.sqrt(u*u+d*d),z=t.radius+s.point.radius;z>M&&(M=(M-z)/M*.5,t.x-=u*=M,t.y-=d*=M,s.point.x+=u,s.point.y+=d)}return n>i||e>l||o>r||a>c}}var s=MessiViz.GOALS_SELECTED.map(function(t){return t.radius=8,t});s.unshift({radius:0,fixed:!0});var e=i.layout.force().gravity(.08).charge(function(t,s){return t.fixed?0:-10}).nodes(s).size([MessiViz.width,MessiViz.height]);MessiViz.groups.forceLayout||(MessiViz.groups.forceLayout=MessiViz.svg.append("g").classed("force-layout",!0)),e.start();var a=MessiViz.groups.forceLayout.selectAll("circle.goal").data(s.slice(1));a.exit().remove(),a.enter().append("svg:circle").attr("r",function(t){return t.radius}).attr("cx",0).attr("cy",0),a.attr("fill","#111").attr("class",function(t){return"match"+t.match_id}).classed("goal",!0),e.on("tick",function(e){s[0].x=MessiViz.width/2,s[0].y=MessiViz.height/2;for(var a=i.geom.quadtree(s),r=0,n=s.length;++r<n;)a.visit(t(s[r]));MessiViz.groups.forceLayout.selectAll("circle.goal").attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y})}),e.resume()},MessiViz.goalsByHow=function(){e("#item-goals h4").each(function(t){var s=e(this);s.css("color",MessiViz.colorHow(s.data("how")))}),MessiViz.groups.forceLayout.selectAll("circle.goal").attr("fill",function(t){return MessiViz.colorHow(t.how)})},MessiViz.goalsByTeam=function(){e("#item-teams h4").each(function(t){var s=e(this);s.css("color",MessiViz.colorTeam(s.data("team")))}),MessiViz.groups.forceLayout.selectAll("circle.goal").attr("fill",function(t){return MessiViz.colorTeam(t.team)})},MessiViz.hideForceLayout=function(){MessiViz.groups.forceLayout&&MessiViz.groups.forceLayout.selectAll("circle.goal").transition().attr("r",0).remove()},MessiViz.clearBars=function(){i.selectAll("rect.bar-unit").attr("fill","#ddd"),i.selectAll("text.totals-label,text.totals-label-assists").style("opacity",0)},MessiViz.showBars=function(){i.selectAll("rect.bar-unit").attr("fill",function(t,s){return MessiViz.color(t.competition)}),i.selectAll("text.totals-label,text.totals-label-assists").style("opacity",1)},MessiViz.updateTotals=function(t){var s=0,e=0,i=0,a=0,r=0,n=0,o=0,l=t.length;MessiViz.GOALS_SELECTED=[],t.forEach(function(t){s+=parseInt(t.goals),e+=parseInt(t.assists),i+=parseInt(t.minutes),"Argentina"==t.team?(a++,t.goals>0&&(n+=parseInt(t.goals))):(r++,t.goals>0&&(o+=parseInt(t.goals))),t.details.length&&(MessiViz.GOALS_SELECTED=_.concat(MessiViz.GOALS_SELECTED,t.details.map(function(s){return s.match_id=t.id,s.team=t.team,s})))}),MessiViz.updateGoals(),MessiViz.totals.$goals.countTo({from:parseInt(MessiViz.totals.$goals.html()),to:s,speed:1e3,formatter:function(t,s){return t.toFixed(s.decimals)}}),MessiViz.totals.$assists.countTo({from:parseInt(MessiViz.totals.$assists.html()),to:e,speed:1e3,formatter:function(t,s){return t.toFixed(s.decimals)}}),MessiViz.totals.$minutes.countTo({from:parseInt(MessiViz.totals.$minutes.html()),to:i,speed:1e3,formatter:function(t,s){return t.toFixed(s.decimals)}}),MessiViz.totals.$matches.countTo({from:parseInt(MessiViz.totals.$matches.html()),to:l,speed:1e3,formatter:function(t,s){return t.toFixed(s.decimals)}}),MessiViz.totals.$goalsArg.countTo({from:parseInt(MessiViz.totals.$goalsArg.html()),to:n,speed:1e3,formatter:function(t,s){return t.toFixed(s.decimals)}}),MessiViz.totals.$goalsBar.countTo({from:parseInt(MessiViz.totals.$goalsBar.html()),to:o,speed:1e3,formatter:function(t,s){return t.toFixed(s.decimals)}})},MessiViz.updateGoals=function(){var t=i.nest().key(function(t){return t.how}).map(MessiViz.GOALS_SELECTED);MessiViz.totals.$goalsLeft.countTo({from:parseInt(MessiViz.totals.$goalsLeft.html()),to:t["Left foot"]?t["Left foot"].length:0,speed:1e3,formatter:function(t,s){return t.toFixed(s.decimals)}}),MessiViz.totals.$goalsRight.countTo({from:parseInt(MessiViz.totals.$goalsRight.html()),to:t["Right foot"]?t["Right foot"].length:0,speed:1e3,formatter:function(t,s){return t.toFixed(s.decimals)}}),MessiViz.totals.$goalsHead.countTo({from:parseInt(MessiViz.totals.$goalsHead.html()),to:t.Head?t.Head.length:0,speed:1e3,formatter:function(t,s){return t.toFixed(s.decimals)}}),MessiViz.totals.$goalsChest.countTo({from:parseInt(MessiViz.totals.$goalsChest.html()),to:t.Chest?t.Chest.length:0,speed:1e3,formatter:function(t,s){return t.toFixed(s.decimals)}}),MessiViz.totals.$goalsHand.countTo({from:parseInt(MessiViz.totals.$goalsHand.html()),to:t.Hand?t.Hand.length:0,speed:1e3,formatter:function(t,s){return t.toFixed(s.decimals)}}),MessiViz.updateBySlide()},MessiViz.next=function(){MessiViz.unhover(null,MessiViz.SELECTED),MessiViz.SELECTED<MessiViz.MATCHES.length-1?MessiViz.SELECTED++:MessiViz.SELECTED=0,MessiViz.hover(i.select("rect.match"+MessiViz.SELECTED).datum(),MessiViz.SELECTED)},MessiViz.prev=function(){MessiViz.unhover(null,MessiViz.SELECTED),MessiViz.SELECTED>0?MessiViz.SELECTED--:MessiViz.SELECTED=MessiViz.MATCHES.length-1,MessiViz.hover(i.select("rect.match"+MessiViz.SELECTED).datum(),MessiViz.SELECTED)},MessiViz.filter=function(t,s){var e=MessiViz.MATCHES.filter(function(e){return e[t]==s});MessiViz.renderD3Chart(e)},MessiViz.clear=function(){MessiViz.renderD3Chart(MessiViz.MATCHES)}}(window,document,jQuery,d3);